<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8">
<title>Login</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="{{ url_for('static', filename='css/styles.css') }}" rel="stylesheet">
</head>
<body class="d-flex justify-content-center align-items-center vh-100">

  <form method="POST" class="login-card text-center">
    <div class="login-logo">ST</div>
    <h4 class="mb-2">游댏 Iniciar sesi칩n</h4>
    <p class="form-help mb-3">Ingresa tus credenciales</p>

    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <!-- toasts se renderizan abajo, no duplicar alert arriba -->
      {% endif %}
    {% endwith %}

    <input class="form-control mb-2" name="user" placeholder="Usuario" required autofocus>
    <input type="password" class="form-control mb-3" name="password" placeholder="Contrase침a" required>

    <button class="btn btn-primary w-100 mb-2">Entrar</button>

    <div class="text-muted" style="font-size:0.85rem">Usuario de prueba: <strong>admin</strong> / 1234</div>
  </form>

  <!-- contenedor toasts -->
  <div id="toastContainer" class="toast-container-bottom" aria-live="polite" aria-atomic="true">
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% for cat, msg in messages %}
        {% if cat == 'success' %}
          {% set svg_path = '<svg class="toast-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M20 6L9 17l-5-5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>' %}
          {% set title = '칄xito' %}
        {% elif cat == 'warning' %}
          {% set svg_path = '<svg class="toast-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10.29 3.86L1.82 18a1.99 1.99 0 0 0 1.71 3h16.94a1.99 1.99 0 0 0 1.72-3L13.71 3.86a2 2 0 0 0-3.42 0z" stroke="currentColor" stroke-width="0" fill="currentColor"/></svg>' %}
          {% set title = 'Atenci칩n' %}
        {% elif cat == 'danger' %}
          {% set svg_path = '<svg class="toast-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M18.36 5.64L5.64 18.36M5.64 5.64l12.72 12.72" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>' %}
          {% set title = 'Error' %}
        {% else %}
          {% set svg_path = '<svg class="toast-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/></svg>' %}
          {% set title = 'Notificaci칩n' %}
        {% endif %}

        <div class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-delay="3500">
          <div class="toast-header custom" style="color:var(--orange);">
            <span style="color:var(--orange);display:flex;align-items:center;">{{ svg_path | safe }}</span>
            <strong class="me-auto toast-title">{{ title }}</strong>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast" aria-label="Cerrar"></button>
          </div>
          <div class="toast-body">{{ msg }}</div>
        </div>
      {% endfor %}
    {% endwith %}
  </div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function(){
  const toastContainer = document.getElementById('toastContainer');
  if (!toastContainer) return;
  const toastEls = toastContainer.querySelectorAll('.toast');
  toastEls.forEach(function(el){
    const svg = el.querySelector('svg');
    if(svg) svg.style.color = getComputedStyle(document.documentElement).getPropertyValue('--orange').trim();
    const t = new bootstrap.Toast(el);
    t.show();
  });
});
</script>
</body>
</html>
